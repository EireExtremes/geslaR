<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="geslaR">
<title>Introduction to Apache Arrow framework • geslaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Apache Arrow framework">
<meta property="og:description" content="geslaR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">geslaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/intro-to-geslaR.html">Dealing with the GESLA dataset in R</a>
    <a class="dropdown-item" href="../articles/intro-to-arrow.html">Introduction to Apache Arrow framework</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EireExtremes/geslaR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to Apache Arrow framework</h1>
                        <h4 data-toc-skip class="author">Fernando Mayer,
Niamh Cahill</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EireExtremes/geslaR/blob/HEAD/vignettes/intro-to-arrow.Rmd" class="external-link"><code>vignettes/intro-to-arrow.Rmd</code></a></small>
      <div class="d-none name"><code>intro-to-arrow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-apache-arrow-framework">The Apache Arrow framework<a class="anchor" aria-label="anchor" href="#the-apache-arrow-framework"></a>
</h2>
<p>The definition of the Apache Arrow framework is best described from
their website:</p>
<blockquote>
<p>Apache Arrow is a software development platform for building high
performance applications that process and transport large data sets. It
is designed to both improve the performance of analytical algorithms and
the efficiency of moving data from one system or programming language to
another.</p>
</blockquote>
<blockquote>
<p>A critical component of Apache Arrow is its in-memory columnar
format, a standardized, language-agnostic specification for representing
structured, table-like datasets in-memory. This data format has a rich
data type system (including nested and user-defined data types) designed
to support the needs of analytic database systems, data frame libraries,
and more.</p>
</blockquote>
<p>In other words, the Apache Arrow framework was designed to deal with
large datasets (larger than memory), using in-memory analytics. This
means that the computations made with “Arrow datasets” are extremely
efficient, resulting in very fast computations, otherwise infeasible
with standard computations.</p>
<p>The Apache Arrow framework can be used in many different programming
languages. However, in each of these languages, there are specific
libraries to deal with it. In R, the <a href="https://arrow.apache.org/docs/r/index.html" class="external-link">arrow</a> package is
available to load and manipulate Arrow datasets. The manipulation of
Arrow objects are made through <a href="https://dplyr.tidyverse.org/index.html" class="external-link">dplyr</a> verbs, which
helps users to feel familiar with it. Not all <strong>dplyr</strong>
verbs are available to work with Arrow datasets, but the vast majority
of the most used ones are already “translated” to be used with Arrow. A
list of such functions can be found in <a href="https://arrow.apache.org/docs/r/reference/acero.html" class="external-link">Functions
available in Arrow dplyr queries</a>. A general introduction of using
<strong>dplyr</strong> verbs with Arrow can be seen in <a href="https://arrow.apache.org/docs/r/articles/data_wrangling.html" class="external-link">Data
analysis with dplyr syntax</a>.</p>
</div>
<div class="section level2">
<h2 id="using-apache-arrow-with-geslar">Using Apache Arrow with geslaR<a class="anchor" aria-label="anchor" href="#using-apache-arrow-with-geslar"></a>
</h2>
<p>The <strong>geslaR</strong> package makes use of the <a href="https://arrow.apache.org" class="external-link">Apache Arrow</a> framework to deal with
the <a href="https://gesla787883612.wordpress.com" class="external-link">GESLA</a> dataset in
R.</p>
<p>In this tutorial, we will use the <code><a href="../reference/download_gesla.html">download_gesla()</a></code>
function, to download the full GESLA dataset, and show some basic data
manipulation with the <strong>arrow</strong> package and
<strong>dplyr</strong> verbs.</p>
<p>The first time you load the <strong>geslaR</strong> package, it will
automatically load both the <strong>arrow</strong> and
<strong>dplyr</strong> packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EireExtremes/geslaR" class="external-link">geslaR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: arrow</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'arrow'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     timestamp</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<p>To download the full GESLA dataset, one can simply use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/download_gesla.html">download_gesla</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will create a directory called <code>gesla_dataset</code> in the
current working directory (as defined by <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code>) and
download the full dataset locally. This download may take some time
(expect around 5 to 10 minutes), as it depends on internet connection.
Note that this full dataset will need at least 7GB of (hard drive)
storage, so make sure this is feasible. However, once downloaded, you
will have access to the full dataset, and you will only need to do this
once.</p>
<p>You will notice that the full dataset is composed of 5119 <a href="https://parquet.apache.org" class="external-link">Apache Parquet</a> files, ending in
<code>.parquet</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Number of downloaded files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"gesla_dataset"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5119</span></span>
<span><span class="co">## Check the first files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"gesla_dataset"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a121-a12-nld-cmems.parquet"      "a2-a2-bel-cmems.parquet"        </span></span>
<span><span class="co">#&gt; [3] "aalesund-aal-nor-cmems.parquet"  "aarhus-aar-dnk-cmems.parquet"   </span></span>
<span><span class="co">#&gt; [5] "aasiaat-aas-grl-gloss.parquet"   "abashiri-347a-jpn-uhslc.parquet"</span></span></code></pre></div>
<p>These files are the same as those originally distributed in the GESLA
database, so that each one refers to a site from where the data comes
from. To load this full dataset in R, use the
<code><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">arrow::open_dataset()</a></code> function, specifying the location of
the <code>.parquet</code> files. Although there are many files, this
function recognizes them as a single dataset, because they all have the
same structure (or “Schema”).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Open dataset</span></span>
<span><span class="va">da</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">(</span><span class="st">"gesla_dataset"</span><span class="op">)</span></span>
<span><span class="co">## Check the object</span></span>
<span><span class="va">da</span></span>
<span><span class="co">#&gt; FileSystemDataset with 5119 Parquet files</span></span>
<span><span class="co">#&gt; date_time: timestamp[us]</span></span>
<span><span class="co">#&gt; year: int64</span></span>
<span><span class="co">#&gt; month: int64</span></span>
<span><span class="co">#&gt; day: int64</span></span>
<span><span class="co">#&gt; hour: int64</span></span>
<span><span class="co">#&gt; country: string</span></span>
<span><span class="co">#&gt; site_name: string</span></span>
<span><span class="co">#&gt; lat: double</span></span>
<span><span class="co">#&gt; lon: double</span></span>
<span><span class="co">#&gt; sea_level: double</span></span>
<span><span class="co">#&gt; qc_flag: int64</span></span>
<span><span class="co">#&gt; use_flag: int64</span></span>
<span><span class="co">#&gt; file_name: string</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; See $metadata for additional Schema metadata</span></span>
<span><span class="co">## Verify class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "FileSystemDataset" "Dataset"           "ArrowObject"      </span></span>
<span><span class="co">#&gt; [4] "R6"</span></span></code></pre></div>
<p>Since this is an <code>ArrowObject</code> object, it will actually
not load the full dataset in memory (as it would if it was a standard R
object, such as a <code>tibble</code> or <code>data.frame</code>). Note,
however, that some basic information, such as <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code> and
<code><a href="https://rdrr.io/r/base/names.html" class="external-link">names()</a></code> can be retrieved simply with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1172435674         13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "date_time" "year"      "month"     "day"       "hour"      "country"  </span></span>
<span><span class="co">#&gt;  [7] "site_name" "lat"       "lon"       "sea_level" "qc_flag"   "use_flag" </span></span>
<span><span class="co">#&gt; [13] "file_name"</span></span></code></pre></div>
<p>Any other manipulation of the dataset must be made using
<strong>dplyr</strong> verbs. For example, to count the number of
observations by country, one could use</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span></span>
<span><span class="co">#&gt; FileSystemDataset (query)</span></span>
<span><span class="co">#&gt; country: string</span></span>
<span><span class="co">#&gt; n: int64</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; See $.data for the source Arrow object</span></span></code></pre></div>
<p>Note, however, that the output is just a query to the full dataset.
To explicitly return the calculation, you should use
<code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code>, so the result is a standard
<code>tibble</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 113 × 2</span></span>
<span><span class="co">#&gt;    country         n</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 BEL       1263467</span></span>
<span><span class="co">#&gt;  2 JPN      74580447</span></span>
<span><span class="co">#&gt;  3 NOR      28452201</span></span>
<span><span class="co">#&gt;  4 DNK      36726648</span></span>
<span><span class="co">#&gt;  5 USA     243838504</span></span>
<span><span class="co">#&gt;  6 GBR      76038844</span></span>
<span><span class="co">#&gt;  7 SLV        812230</span></span>
<span><span class="co">#&gt;  8 MEX      10755284</span></span>
<span><span class="co">#&gt;  9 CAN      67019312</span></span>
<span><span class="co">#&gt; 10 NLD     133699230</span></span>
<span><span class="co">#&gt; # ℹ 103 more rows</span></span></code></pre></div>
<p>This is intentionally done so that you can manipulate, calculate, and
extract information from the dataset, taking advantage of the Arrow
in-memory analytics framework. This way, the computations should be
faster, and the idea is that you just use <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code>
when the final result is needed as an R object. For example, we could
calculate the mean sea level for Ireland per year as</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"IRL"</span>, <span class="va">use_flag</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 63 × 2</span></span>
<span><span class="co">#&gt;     year  mean</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  1958  3.11</span></span>
<span><span class="co">#&gt;  2  1959  3.12</span></span>
<span><span class="co">#&gt;  3  1960  3.16</span></span>
<span><span class="co">#&gt;  4  1961  3.16</span></span>
<span><span class="co">#&gt;  5  1962  3.09</span></span>
<span><span class="co">#&gt;  6  1963  3.13</span></span>
<span><span class="co">#&gt;  7  1964  3.13</span></span>
<span><span class="co">#&gt;  8  1965  3.11</span></span>
<span><span class="co">#&gt;  9  1966  3.15</span></span>
<span><span class="co">#&gt; 10  1967  3.14</span></span>
<span><span class="co">#&gt; # ℹ 53 more rows</span></span></code></pre></div>
<p>Any other queries could be made, as long as the
<strong>dplyr</strong> verbs used are supported by the
<strong>arrow</strong> package. For example, we could ask for the
minimum, mean, and maximum sea level values for Ireland per year</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"IRL"</span>, <span class="va">use_flag</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>        min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span>,</span>
<span>        mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span>,</span>
<span>        max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 63 × 4</span></span>
<span><span class="co">#&gt;     year   min     mean   max</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  2018 -4.09  0.0462  11.6 </span></span>
<span><span class="co">#&gt;  2  2019 -5.80  0.0436   3.18</span></span>
<span><span class="co">#&gt;  3  2003 -1.13 -0.00629  0.9 </span></span>
<span><span class="co">#&gt;  4  2004 -1.11  0.0391   4.07</span></span>
<span><span class="co">#&gt;  5  2005 -1.32  1.32     4.83</span></span>
<span><span class="co">#&gt;  6  2006 -2.47  0.692    4.94</span></span>
<span><span class="co">#&gt;  7  2007 -3.48 -0.0374   4.94</span></span>
<span><span class="co">#&gt;  8  2008 -3.41 -0.00481  4.85</span></span>
<span><span class="co">#&gt;  9  2009 -3.00  0.0108   2.94</span></span>
<span><span class="co">#&gt; 10  2010 -3.71 -0.0192   3.11</span></span>
<span><span class="co">#&gt; # ℹ 53 more rows</span></span></code></pre></div>
<p>This same query could then be used to produce graphics with
<strong>ggplot2</strong>, for example. In this case, note that the call
to <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code> is mandatory in advance of using
<strong>ggplot2</strong> functions, as it will only accept standard R
objects (such as <code>tibble</code> or <code>data.frame</code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"IRL"</span>, <span class="va">use_flag</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>        min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span>,</span>
<span>        mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span>,</span>
<span>        max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sea_level</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">min</span>, <span class="va">mean</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig-gg-irl-1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fernando Mayer, Niamh Cahill.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
