<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="geslaR">
<title>Introduction to Apache Arrow framework • geslaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Apache Arrow framework">
<meta property="og:description" content="geslaR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">geslaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-arrow.html">Introduction to Apache Arrow framework</a>
    <a class="dropdown-item" href="../articles/intro-to-geslaR.html">Dealing with the GESLA dataset in R</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EireExtremes/geslaR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to Apache Arrow framework</h1>
                        <h4 data-toc-skip class="author">Fernando Mayer,
Niamh Cahill</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EireExtremes/geslaR/blob/HEAD/vignettes/intro-to-arrow.Rmd" class="external-link"><code>vignettes/intro-to-arrow.Rmd</code></a></small>
      <div class="d-none name"><code>intro-to-arrow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-apache-arrow-framework">The Apache Arrow framework<a class="anchor" aria-label="anchor" href="#the-apache-arrow-framework"></a>
</h2>
<p>The definition of the Apache Arrow framework is best described from
their website:</p>
<blockquote>
<p>Apache Arrow is a software development platform for building high
performance applications that process and transport large data sets. It
is designed to both improve the performance of analytical algorithms and
the efficiency of moving data from one system or programming language to
another.</p>
</blockquote>
<blockquote>
<p>A critical component of Apache Arrow is its in-memory columnar
format, a standardized, language-agnostic specification for representing
structured, table-like datasets in-memory. This data format has a rich
data type system (included nested and user-defined data types) designed
to support the needs of analytic database systems, data frame libraries,
and more.</p>
</blockquote>
<p>In other words, the Apache Arrow framework was designed to deal with
large datsets (larger than memory), using in-memory analytics. This
means that the computations made with “Arrow datasets” are extremaly
efficient, resulting in very fast computations, otherwise infeasible
with standard computations.</p>
<p>The Apache Arrow framework can be used in many different programming
languages. However, in each of this languages, there are specific
libraries to deal with it. In R, the <a href="https://arrow.apache.org/docs/r/index.html" class="external-link">arrow</a> package is
available to load and manipulate Arrow datasets. The manipulation of
Arrow objects are made through <a href="https://dplyr.tidyverse.org/index.html" class="external-link">dplyr</a> verbs, which
helps users to feel familiar with it. Not all <strong>dplyr</strong>
verbs are availbale to work with Arrow datasets, but the vast majority
of the most used ones are already “translated” to be used with Arrow. A
list of such functions can be found in <a href="https://arrow.apache.org/docs/r/reference/acero.html" class="external-link">Functions
available in Arrow dplyr queries</a>. A general introduction of using
<strong>dplyr</strong> verbs with Arrow can be seen in <a href="https://arrow.apache.org/docs/r/articles/data_wrangling.html" class="external-link">Data
analysis with dplyr syntax</a>.</p>
</div>
<div class="section level2">
<h2 id="using-apache-arrow-with-geslar">Using Apache Arrow with geslaR<a class="anchor" aria-label="anchor" href="#using-apache-arrow-with-geslar"></a>
</h2>
<p>The <strong>geslaR</strong> package makes use of the <a href="https://arrow.apache.org" class="external-link">Apache Arrow</a> framework to deal with
the <a href="https://gesla787883612.wordpress.com" class="external-link">GESLA</a> dataset in
R.</p>
<p>In this tutorial, we will use the <code><a href="../reference/download_gesla.html">download_gesla()</a></code>
function, to download the full GESLA dataset, and show some basic data
manipulation with the <strong>arrow</strong> package and
<strong>dplyr</strong> verbs.</p>
<p>The first time you load the <strong>geslaR</strong> package, it will
automatically load both the <strong>arrow</strong> and
<strong>dplyr</strong> packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EireExtremes/geslaR" class="external-link">geslaR</a></span><span class="op">)</span></span></code></pre></div>
<p>To download the full GESLA dataset, one can simply use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/download_gesla.html">download_gesla</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ The total size of the dataset is about 7GB, and the download time will depend on your</span></span>
<span><span class="co">#&gt; internet connection</span></span>
<span><span class="co">#&gt; Do you want to download the whole dataset? </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1: Yes</span></span>
<span><span class="co">#&gt; 2: No</span></span>
<span><span class="co">#&gt; ℹ Wait while the dataset is downloaded...</span></span>
<span><span class="co">#&gt; ℹ Dataset downloaded to './gesla_dataset'</span></span></code></pre></div>
<p>This will create a directory called <code>gesla_dataset</code> in the
current working directory (as defined by <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code>) and
download the full dataset locally. This downlopad may take some time, as
it depends on internet connection, but it’s necessary only once. Note
that this full dataset will need at least 7GB of (hard drive) storage,
so make sure this is feasible. However, once downloaded, you will have
access to the full dataset, and you will only need to do this once.</p>
<p>To load this full dataset in R, use</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">(</span><span class="st">"gesla_dataset"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "FileSystemDataset" "Dataset"           "ArrowObject"       "R6"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18189361       13</span></span></code></pre></div>
<p>Since this is an <code>ArrowObject</code> object, it will actually
not load the full dataset in memory (as it would if it was a standard R
object, such as a <code>tibble</code> or <code>data.frame</code>). To
deal with this object, you can use <code>dplyr</code> verbs. For
example, to count the number of observations by country, one could
use</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span></span>
<span><span class="co">#&gt; FileSystemDataset (query)</span></span>
<span><span class="co">#&gt; country: string</span></span>
<span><span class="co">#&gt; n: int64</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; See $.data for the source Arrow object</span></span></code></pre></div>
<p>Note, however, that the output is just a query to the full dataset.
To explicitly return the calculation, you should use
<code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code>, so the result is a standard
<code>tibble</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">da</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 2</span></span>
<span><span class="co">#&gt;   country        n</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 IRL     16975901</span></span>
<span><span class="co">#&gt; 2 ATA      1084526</span></span>
<span><span class="co">#&gt; 3 FRA       128934</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fernando Mayer, Niamh Cahill.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
